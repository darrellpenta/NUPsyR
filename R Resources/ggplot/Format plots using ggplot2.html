
<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>Noam Ross | How to format plots for publication using ggplot2 (with some help from Inkscape)</title>
  <meta name="description" content=" " />
  <meta name="author" content="Noam Ross">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Noam Ross">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://feeds.feedburner.com/noamross" rel="alternate" type="application/rss+xml" title="Noam Ross" />
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30394461-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>
 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/0.3.1/showdown.min.js" type="text/javascript"></script>
<!--  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script> -->
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">stLight.options({publisher: "4376beef-ffcc-441e-a877-904acf7f379b", theme:'8', onhover:false, doNotHash:true, doNotCopy:true, hashAddressBar:false}); </script>
  <script type="text/javascript">
      function chgifr(url, iframe)  {
          document.getElementById(iframe).src = url;
      }
  </script>
  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>  
</head>
<body>
<div class="wrapper">
  <div class="blog">
 
      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Noam Ross</a></h1>
          <div class="blog-description">
           <h2>Real-time research in ecology, economics, and sustainability</h2>
          </div>
         </div>
          <div class="pages">
            
            <!-- Lockerz Share BEGIN -->
            <a class="a2a_dd" href="http://www.addtoany.com/share_save" tile"Share this Page"><span class="shareicon"><span class="hide">Share</span></span></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.onclick = 0;
            a2a_config.show_title = 1;
            a2a_config.color_main = "FFFFFF";
            a2a_config.color_border = "FFFFFF";
            a2a_config.color_link_text = "45462f";
            a2a_config.color_link_text_hover = "575757";
            a2a_config.prioritize = ["twitter", "facebook", "tumblr", "email", "delicious", "linkedin", "stumbleupon", "google_plus"];
            </script>
            <script type="text/javascript" src="http://static.addtoany.com/menu/page.js"></script>
            <!-- Lockerz Share END -->
            
            <a href="http://feeds.feedburner.com/noamross" title="Subscribe via Feedburner RSS"> <span class="rssicon"> <span class="hide">RSS</span></span></a>
            
             
             
            


  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/about.html">About</a>
    	
    
  
    
  
    
  
    
  
    
    	
    	<a href="/connect.html">Connect</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/index.html">Blog</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/publications.html">Publications</a>
    	
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/tags.html">Topics</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/2013/11/20/formatting-plots-for-pubs.html">How to format plots for publication using ggplot2 (with some help from Inkscape)</a></h1>
<p>by <em>Rosemary Hartman</em>, 20 November 2013</p>
<hr />
</div>
<div class="contenttext"><p><p><strong><em>The following is the code from a presentation made by Rosemary Hartman to the <a href="http://www.noamross.net/davis-r-users-group.html">Davis R Users’ Group</a>. I’ve run the code through the <code>spin</code> function in <code>knitr</code> to produce this post. Download the script to walk through <a href="https://gist.github.com/noamross/7576436">here</a>.</em></strong></p>
<p>First, make your plot. I am going to use the data already in R about sleep habits of different animals. It’s the same one Noam used for <a href="http://www.noamross.net/blog/2012/10/5/ggplot-introduction.html">his intro to ggplot.</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">str</span>(msleep)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    83 obs. of  11 variables:
##  $ name        : chr  &quot;Cheetah&quot; &quot;Owl monkey&quot; &quot;Mountain beaver&quot; &quot;Greater short-tailed shrew&quot; ...
##  $ genus       : chr  &quot;Acinonyx&quot; &quot;Aotus&quot; &quot;Aplodontia&quot; &quot;Blarina&quot; ...
##  $ vore        : Factor w/ 4 levels &quot;carni&quot;,&quot;herbi&quot;,..: 1 4 2 4 2 2 1 NA 1 2 ...
##  $ order       : chr  &quot;Carnivora&quot; &quot;Primates&quot; &quot;Rodentia&quot; &quot;Soricomorpha&quot; ...
##  $ conservation: Factor w/ 7 levels &quot;&quot;,&quot;cd&quot;,&quot;domesticated&quot;,..: 5 NA 6 5 3 NA 7 NA 3 5 ...
##  $ sleep_total : num  12.1 17 14.4 14.9 4 14.4 8.7 7 10.1 3 ...
##  $ sleep_rem   : num  NA 1.8 2.4 2.3 0.7 2.2 1.4 NA 2.9 NA ...
##  $ sleep_cycle : num  NA NA NA 0.133 0.667 ...
##  $ awake       : num  11.9 7 9.6 9.1 20 9.6 15.3 17 13.9 21 ...
##  $ brainwt     : num  NA 0.0155 NA 0.00029 0.423 NA NA NA 0.07 0.0982 ...
##  $ bodywt      : num  50 0.48 1.35 0.019 600 ...</code></pre>
<p>Let’s say we have written a groundbreaking paper on the relationship between body size and sleep time. Therefore, we want to present a plot of the log of body weight by the total sleep time</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(bodywt), <span class="dt">y =</span> sleep_total)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> vore))
sleepplot</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-2.png" />
</figure>
<p>We made a beautiful model of this relationship</p>
<pre class="sourceCode r"><code class="sourceCode r">slp =<span class="st"> </span><span class="kw">lm</span>(sleep_total ~<span class="st"> </span><span class="kw">log</span>(bodywt), <span class="dt">data =</span> msleep)
<span class="kw">summary</span>(slp)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## 
## Call:
## lm(formula = sleep_total ~ log(bodywt), data = msleep)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -6.499 -2.567 -0.168  2.047 10.193 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   11.089      0.418   26.54   &lt;2e-16 ***
## log(bodywt)   -0.777      0.125   -6.22    2e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.68 on 81 degrees of freedom
## Multiple R-squared:  0.323,  Adjusted R-squared:  0.315 
## F-statistic: 38.7 on 1 and 81 DF,  p-value: 2.05e-08</code></pre>
<p>Let’s put the model on the plot</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot =<span class="st"> </span>sleepplot +<span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(slp)[<span class="dv">1</span>], <span class="dt">slope =</span> <span class="kw">coef</span>(slp)[<span class="dv">2</span>])
sleepplot</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-4.png" />
</figure>
<p>It’s beautiful! I love it! Unfortunately, you want to submit to Science (you might as well aim high), and this is what they say about figures: <a href="http://www.sciencemag.org/site/feature/contribinfo/prep/prep_subfigs.xhtml" class="uri">http://www.sciencemag.org/site/feature/contribinfo/prep/prep_subfigs.xhtml</a></p>
<p>So we have several problems:</p>
<ul>
<li>gray background</li>
<li>Poor labels (need units, capital letters, larger font on axes)</li>
<li>Poor legend</li>
<li>Poor color scheme (avoid red and green together, more contrast needed)</li>
<li>Not correct file format or resolution (want a PDF with at least 600dpi)</li>
</ul>
<p>First make the labels a little more useful.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot =<span class="st"> </span>sleepplot +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Log body weight (Kg)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Time asleep (hrs/day)&quot;</span>)
sleepplot</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-5.png" />
</figure>
<p>Now let’s fix the legend. You would think you do this with some sort of “legend” command, but <em>no</em>, what you are looking for is “scale”.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot +<span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Functional</span><span class="ch">\n</span><span class="st"> feeding group&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;carnivore&quot;</span>, 
    <span class="st">&quot;herbivore&quot;</span>, <span class="st">&quot;insectivore&quot;</span>, <span class="st">&quot;omnivore&quot;</span>))</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-6.png" />
</figure>
<p>If you haven’t figured it out yet, putting “<code>\n</code>” in a text string gives you a line break. It took me WAY to long to discover that.</p>
<p><code>ggplot</code> automatically gives you evenly spaced hues for color variations, but this is not necessarily the best way to get a good contrasting color scheme. You may want to try <code>scale_color_brewer</code> for better contrasts. See <a href="http://colorbrewer2.org" class="uri">http://colorbrewer2.org</a> for more information.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot +<span class="st"> </span><span class="kw">scale_color_brewer</span>(<span class="dt">name =</span> <span class="st">&quot;Functional </span><span class="ch">\n</span><span class="st"> feeding group&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;carnivore&quot;</span>, 
    <span class="st">&quot;herbivore&quot;</span>, <span class="st">&quot;insectivore&quot;</span>, <span class="st">&quot;omnivore&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="dt">palette =</span> <span class="dv">1</span>)</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-7.png" />
</figure>
<p>Oh, crap! Color figures cost an extra $700 on top of the normal page charges! Let’s try something else:</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(bodywt), <span class="dt">y =</span> sleep_total)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>vore), <span class="dt">size=</span><span class="dv">3</span>) +<span class="st"> </span><span class="co">#&#39; This time we will vary the feeding groups by shapes instead of colors</span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept=</span><span class="kw">coef</span>(slp)[<span class="dv">1</span>], <span class="dt">slope=</span><span class="kw">coef</span>(slp)[<span class="dv">2</span>])
  sleepplot2</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-8.png" />
</figure>
<p>Now to fix the labels and legend again:</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 =<span class="st"> </span>sleepplot2 +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Log body weight (Kg)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Time asleep (hrs/day)&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="co">#&#39; we will use scale_shape_discrete instead of scale_color_discrete</span>
<span class="kw">scale_shape_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Functional </span><span class="ch">\n</span><span class="st"> feeding group&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;carnivore&quot;</span>, 
    <span class="st">&quot;herbivore&quot;</span>, <span class="st">&quot;insectivore&quot;</span>, <span class="st">&quot;omnivore&quot;</span>))
sleepplot2</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-9.png" />
</figure>
<p>Now, let’s work on how the plot looks overall.</p>
<p>ggplot uses “themes” to adjust plot appearence without changes the actual presentation of the data.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">12</span>, <span class="dt">base_family =</span> <span class="st">&quot;Helvetica&quot;</span>)</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-10.png" />
</figure>
<p><code>theme_bw()</code> will get rid of the background, and gives you options to change the font. Science recomends Helvetica, wich happens to be R’s default, but we will specify it here anyway.</p>
<p>Check out the other fonts out here:</p>
<pre class="sourceCode r"><code class="sourceCode r">??postscriptFonts</code></pre>
<p>For even more fonts, see the <code>extrafont</code> package.</p>
<p>Other pre-set themes can change the look of your plot</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">theme_minimal</span>()</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-111.png" />
</figure>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">theme_classic</span>()</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-112.png" />
</figure>
<p>For more themes,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)</code></pre>
<p>If you want to publish in the Wall Street Journal…</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">theme_wsj</span>()</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-13.png" />
</figure>
<p>But we want to publish in Science, not the Wall Street Journal, so let’s get back to our black and white theme.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 =<span class="st"> </span>sleepplot2 +<span class="st"> </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">12</span>, <span class="dt">base_family =</span> <span class="st">&quot;Helvetica&quot;</span>)
sleepplot2</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-14.png" />
</figure>
<p>You can’t really see the gridlines with the <code>bw</code> theme, so we are going to tweak the pre-set theme using the <code>theme</code> function. <code>theme</code> allows you to do all kinds of stuff involved with how the plot looks.</p>
<pre class="sourceCode r"><code class="sourceCode r">?theme</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span>
<span class="st">  </span><span class="co">#increase size of gridlines</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> .<span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;grey&quot;</span>),
  <span class="co">#increase size of axis lines</span>
  <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size=</span>.<span class="dv">7</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),
  <span class="co">#Adjust legend position to maximize space, use a vector of proportion</span>
  <span class="co">#across the plot and up the plot where you want the legend. </span>
  <span class="co">#You can also use &quot;left&quot;, &quot;right&quot;, &quot;top&quot;, &quot;bottom&quot;, for legends on t</span>
  <span class="co">#he side of the plot</span>
  <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">85</span>,.<span class="dv">7</span>),
  <span class="co">#increase the font size</span>
  <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) </code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-15.png" />
</figure>
<p>You can save this theme for later use</p>
<pre class="sourceCode r"><code class="sourceCode r">science_theme =<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;grey&quot;</span>), 
    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.7</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>), <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, 
        <span class="fl">0.7</span>), <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>))
sleepplot2 =<span class="st"> </span>sleepplot2 +<span class="st"> </span>science_theme
sleepplot2</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-16.png" />
</figure>
<p>That looks pretty good. Now we need to get it exported properly. The instructions say the figure should be sized to fit in one or two columns (2.3 or 4.6 inches), so we want them to look good at that resolution.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;sleepplot.pdf&quot;</span>, <span class="dt">width=</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="co">#&#39; see how it looks at this size</span>
    <span class="dt">useDingbats=</span>F) <span class="co">#I have had trouble when uploading figures with digbats before, so I don&#39;t use them</span>
sleepplot2 <span class="co">#print our plot</span>
<span class="kw">dev.off</span>() <span class="co">#stop making pdfs</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## pdf 
##   2</code></pre>
<h4 id="a-few-other-tricks-to-improve-the-look-of-your-plots">A few other tricks to improve the look of your plots:</h4>
<p>Let’s say we are grouping things by categories instead of a regression</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepcat =<span class="st"> </span><span class="kw">ggplot</span>(msleep, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> sleep_total, <span class="dt">color =</span> conservation))
sleepcat +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-18.png" />
</figure>
<p>It’s hard to see what’s going on there, so we can jitter the points to make them more visible.</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepcat +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">w =</span> <span class="fl">0.1</span>))</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-19.png" />
</figure>
<p>Maybe this would be better with averages and error bars instead of every point:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plyr)
msleepave =<span class="st"> </span><span class="kw">ddply</span>(msleep, .(vore, conservation), summarize, <span class="dt">meansleep =</span> <span class="kw">mean</span>(sleep_total), 
    <span class="dt">sdsleep =</span> <span class="kw">sd</span>(sleep_total)/<span class="kw">sqrt</span>(<span class="dv">22</span>))
sleepmean =<span class="st"> </span><span class="kw">ggplot</span>(msleepave, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> meansleep, <span class="dt">color =</span> conservation))</code></pre>
<p>Plot it with means and error bars +/- 1 stadard deviation</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepmean +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> meansleep +<span class="st"> </span>sdsleep, <span class="dt">ymin =</span> meansleep +<span class="st"> </span>
<span class="st">    </span>sdsleep), <span class="dt">width =</span> <span class="fl">0.2</span>)</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-21.png" />
</figure>
<p>Spread them out, but in an orderly fashion this time, with position_dodge rather than jitter</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepmean +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">height =</span> <span class="dv">0</span>), <span class="dt">size =</span> <span class="dv">2</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> meansleep +<span class="st"> </span>sdsleep, <span class="dt">ymin =</span> meansleep -<span class="st"> </span>sdsleep), 
        <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">height =</span> <span class="dv">0</span>), <span class="dt">width =</span> <span class="fl">0.5</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## ymax not defined: adjusting position using y instead</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-22.png" />
</figure>
<p>Note that dodging the points gives the conservation status in the same order for each feeding type category. A little more organized.</p>
<h4 id="some-other-things-you-might-want-to-do-with-formatting">Some other things you might want to do with formatting:</h4>
<p>Add annotation to the plot</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;R2 = 0.999&quot;</span>, <span class="dt">x =</span> -<span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">17</span>)</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-23.png" />
</figure>
<p>Let’s put that annotation in italics</p>
<pre class="sourceCode r"><code class="sourceCode r">sleepplot2 +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;R2 = 0.999&quot;</span>, <span class="dt">x =</span> -<span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">17</span>, <span class="dt">fontface =</span> <span class="dv">3</span>)</code></pre>
<figure>
<img src="http://dl.dropbox.com/u/3356641/blogstuff/roseplot-24.png" />
</figure>
<p>NOW. Let’s put half that annotation in italics, the other half plain, then insert five greek characters and rotate it 90 degrees!</p>
<p>OR we can beat our head against a wall until it explodes and export our plot into an actual graphics program.</p>
<p>Not everything has to be done in R. ‘SVG’ files are vector graphic files that can be easily edited in the FREE GUI-based program <a href="http://inkscape.org/">Inkscape</a>. Make and SVG and you can edit it by hand for final tweaks. Inkscape can also edit and export PDFs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svg</span>(<span class="dt">filename =</span> <span class="st">&quot;sleepplot.svg&quot;</span>, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">4</span>)
sleepplot2
<span class="kw">dev.off</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## pdf 
##   2</code></pre>
</p></div>
<ul class="tags">
  
    <li><strong>Tags: </strong></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
    
    <li><a href="/tags.html#D-RUG-ref">D-RUG</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'noamrossgh'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/2013/11/20/formatting-plots-for-pubs.html';
    var disqus_url = 'http://www.noamross.net/blog/2013/11/20/formatting-plots-for-pubs.html';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint" id="previous-posts"><hr />
<p> <strong>Previous Post</strong>: <a href="/blog/2013/11/7/mbi-poster-post.html">MBI Meeting Poster: Optimal Control of Forest Disease</a> </p>
<p> <strong>Next Post</strong>: <a href="/blog/2014/1/22/eqnfree-writeup.html">Dynamic Optimization in An Equation-Free Framework</a> </p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>
