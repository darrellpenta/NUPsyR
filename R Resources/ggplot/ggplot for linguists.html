<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Kodi Weatherholtz" />
  <title>An Introduction to ggplot for Linguists</title>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="http://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="myslidy.css" />
  <script src="https://d3eoax9i5htok0.cloudfront.net/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script src="http://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js.gz"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">An Introduction to ggplot for Linguists</h1>
  <p class="author">
Kodi Weatherholtz
  </p>
  <p class="date">kweatherholtz@ling.ohio-state.edu</p>
</div>
<div class="section slide level1" id="this-tutorial-is-a-work-in-progress">
<h1>This tutorial is a work in progress</h1>
<br>
<ul>
<li> 
last update: 5/23/2013
</li>
  <li> 
Feel free to email me with questions, comments, suggestions, or corrections.
</li>
</ul>


</div>
<div class="section slide level1" id="structure-of-this-tutorial">
<h1>Structure of this tutorial</h1>
<ul>
  <li> 
Getting Started
<ol>
        <li> 
conceptual overview of ggplot, and some basic plots
</li>
        <li> 
adding regression lines and other basic embellishments
</li>
        <li> 
grouping and statistically transforming data
</li>
        <li> 
cosmetic details (e.g., colour, legends, axis labels)
</li>
      </ol>
  
<br>
<li> 
Visualizing Linguistic Data
<ol start="5">
        <li> 
formant data and vowel plots
</li>
        <li> 
barplots, lineplots, and error bars
</li>
        <li> 
binomial variables and plotting proportions
</li>
        <li> 
geospatial plotting and possibilities for students of variation
</li>
      </ol>
</ul>


</div>
<div class="section slide level1" id="what-is-ggplot">
<h1>What is ggplot?</h1>
<blockquote>
  <p style="font-family:Arial; font-size:13.5pt">
    
<font> “ggplot2 is <b>a plotting system for R</b>, based on the <font color="#CC0000">grammar of graphics</font>, which tries to <b>take the good parts of base and lattice graphics and none of the bad parts</b>. It takes care of many of the fiddly details that make plotting a hassle (like drawing legends) as well as providing a powerful model of graphics that <b>makes it easy to produce complex multi-layered graphics</b>.” </font>
</p>
</blockquote>
  <p align="center" style="font-size:12pt">
  
Hadley Wickham, developer, <a href="http://ggplot2.org/">http://ggplot2.org/ </a>
<p>



</div>
<div class="section slide level1" id="conceptual-overview">
<h1>Conceptual overview</h1>
<blockquote>
  <p style="font-family:Arial; font-size:13.5pt">
    
<font> “ggplot2 is designed to work in <b>a layered fashion</b>, starting with a layer showing the raw data then adding layers of annotations and statistical summaries.” </font>
</p>
</blockquote>
  <p align="center" style="font-size:12pt">
  
Wickham, 2009, <i> ggplot2: Elegant Graphics for Data Analysis </i>
<p>
  
<br>
<ul class="incremental">
<li><p>in base R:<br /> – graphics are composed of simple raw elements (e.g., points, lines)<br /> – it is difficult to add new components to existing graphics (e.g., error bars, legends)</p></li>
<li><p>ggplot:<br /> – graphics involve high-level elements (representations of raw data, statistical transformations)<br /> – elements are easily combined to form complex graphics</p></li>
</ul>
</div>
<div class="section slide level1" id="getting-setup">
<h1>Getting setup</h1>
<pre class="sourceCode r"><code class="sourceCode r">## even if you already have ggplot installed, you should reinstall it, as some
## function and argument names have changed with the release of version 9.2

<span class="co"># install.packages(&#39;ggplot2&#39;)</span>
<span class="kw">require</span>(ggplot2)</code></pre>
</div>
<div class="section slide level1" id="section">

<div style="background: linear-gradient(#252525, #727272); 
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            padding-top:0px;
            padding-left:0px;
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b> Basic Examples </b>
</p>

<BR>
<ul style="color: #CCCCCC; font-size:21pt; padding-left:50px">
    <li>
ggplot syntax
</li>
    <li>
some simple plots
</li>
    <li>
combining geoms to create multi-layered plots
</li>
   </ul> 
</div>
</div>
<div class="section slide level1" id="a-call-to-ggplot-minimally-consists-of">
<h1>A call to ggplot minimally consists of…</h1>
<ol class="incremental" style="list-style-type: decimal">
<li><p>a <font color="red"><b> data frame </b></font></p></li>
<li><p>a set of <font color="blue"><b> aesthetic mappings </b></font><br /> – <font style="font-size:14.5pt"><i>describe how variables in a data frame are mapped to graphical attributes </i></font><br /> – <font style="font-size:14.5pt"> x- and y-axis variables, colo(u)rs, subset groupings, linetypes </font></p></li>
<li><p>one or more <font color="green"><b> geometric objects </b></font>, called <strong>geoms</strong><br /> – <font style="font-size:14.5pt"><i> determine how values are rendered graphically </i></font><br /> – <font style="font-size:14.5pt"> points, lines, boxplots, bars, etc.</font></p></li>
</ol>
<ul class="incremental">
<li>For example:<br /> – ggplot(<font color="red"><b>dataframe</b></font>, <font color="blue"><b> aes</b></font>(x = xvar, y = yvar)) + <font color="green"><b>geom_boxplot</b></font>()</li>
</ul>
</div>
<div class="section slide level1" id="additionally-it-is-possible-to-specify">
<h1>Additionally, it is possible to specify…</h1>
<ol class="incremental" start="4" style="list-style-type: decimal">
<li><p><font color="green"><b>statistical transformations</b></font>, called <b> stats </b><br /> – <font style="font-size:14.5pt"> e.g., regression lines, bootstrapped confidence intervals, log transform of scale and coordinate systems </font></p></li>
<li><p>one or more <font color="green"><b> facets </b></font> to create lattice/trellis plots<br /> – <font style="font-size:15.5pt"> e.g., plot each subject’s data individually </font></p></li>
<li><p>a <font color="green"><b>coordinate system</b></font>, or <b>coord </b><br /> – <font style="font-size:14.5pt"> <i>default is Cartesian coordinates, but other systems can be specified </i></font><br /> – <font style="font-size:14.5pt"> e.g., polar coords, log transformed coords, map projections (latitude and longitude) </font></p></li>
<li><p><font color="green"><b> scales </b></font><br /> – <font style="font-size:14.5pt"> e.g., adjust size of points in a scatterplot to be proportional on a specified scale </font></p></li>
</ol>
</div>
<div class="section slide level1" id="lets-start-with-a-simple-data-set">
<h1>Let’s start with a simple data set</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mtcars is a built in data set. </span>
<span class="kw">head</span>(mtcars)</code></pre>
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Let&#39;s tidy it up a bit</span>
<span class="co"># turn rownames (car model) into vector, and select a subset of columns</span>
df1 &lt;- <span class="kw">data.frame</span>(<span class="dt">model =</span> <span class="kw">as.factor</span>(<span class="kw">row.names</span>(mtcars)), 
                  mtcars[,<span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">1</span>:<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])
<span class="kw">row.names</span>(df1) &lt;- <span class="ot">NULL</span>

<span class="kw">head</span>(df1)</code></pre>
<pre><code>              model carb  mpg cyl  hp    wt
1         Mazda RX4    4 21.0   6 110 2.620
2     Mazda RX4 Wag    4 21.0   6 110 2.875
3        Datsun 710    1 22.8   4  93 2.320
4    Hornet 4 Drive    1 21.4   6 110 3.215
5 Hornet Sportabout    2 18.7   8 175 3.440
6           Valiant    1 18.1   6 105 3.460</code></pre>
</div>
<div class="section slide level1" id="a-simple-scatterplot">
<h1>A simple “scatterplot”</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_point</span>()</code></pre>
<img src="figure/scatter-simple.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="not-the-right-representation">
<h1>Not the right representation…</h1>
<br>
<ul style="font-family: "Gill Sans MT", "Gill Sans", GillSans, sans-serif; font-size:14pt; padding-left:20px">
    <li>
the x-axis variable (number of cylinders) is not a continuous variable, so the data aren’t “scattered”
</li>
        
<br>
<li>
hence, a scatterplot isn’t the most appropriate visualization
</li>
        
<br>
<li>
let’s change the <b>geom</b> to see different visualizations
</li>
   </ul> 





</div>
<div class="section slide level1" id="a-simple-boxplot">
<h1>A simple boxplot</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_boxplot</span>()</code></pre>
<img src="figure/boxplot-simple.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="a-simple-violin-plot">
<h1>A simple violin plot</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>()</code></pre>
<img src="figure/violin-simple.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="default-axis-format-isnt-always-very-readable">
<h1>Default axis format isn’t always very readable</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># adjust formatting of x- and y- axes. </span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>() +
  <span class="co"># change font size, font color, and axis label position</span>
  <span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">15</span>),
        <span class="dt">axis.title.x=</span>  <span class="kw">element_text</span>(<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">18</span>, <span class="dt">vjust=</span>-<span class="fl">0.45</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>, <span class="dt">vjust=</span>.<span class="dv">2</span>),
        <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>))</code></pre>
<img src="figure/axis-format.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="define-theme-for-easy-use-later">
<h1>Define theme for easy use later</h1>
<pre class="sourceCode r"><code class="sourceCode r">my.theme &lt;- <span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">15</span>),
                  <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),
                  <span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">19</span>),
                  <span class="dt">axis.title.x=</span>  <span class="kw">element_text</span>(<span class="dt">vjust=</span>-<span class="fl">0.45</span>),
                  <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span>.<span class="dv">2</span>),
                  <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
                  <span class="dt">axis.line =</span> <span class="kw">element_line</span>())</code></pre>
</div>
<div class="section slide level1" id="combining-geoms">
<h1>Combining geoms</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>() +
  <span class="kw">geom_point</span>() + <span class="co"># add a layer showing raw data points</span>
  my.theme <span class="co"># use the custom theme we just defined</span></code></pre>
<img src="figure/violin-points.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="adjust-parameters-of-one-layer-independently">
<h1>Adjust parameters of one layer independently</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>() +
  <span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">width=</span>.<span class="dv">1</span>)) + <span class="co"># add jitter to points</span>
  my.theme</code></pre>
<img src="figure/violin-points-jitter.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="try-a-different-representation-of-points">
<h1>Try a different representation of points</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>() +
  <span class="kw">geom_dotplot</span>(<span class="dt">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">stackdir =</span> <span class="st">&quot;center&quot;</span>) + <span class="co"># specify which axis to use for &#39;binning&#39;</span>
  my.theme</code></pre>
<img src="figure/violin-dotplot.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="so-those-dots-were-a-little-big">
<h1>… so, those dots were a little big</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_violin</span>() +  
  <span class="kw">geom_dotplot</span>(<span class="dt">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">dotsize =</span> .<span class="dv">65</span>) + <span class="co"># change size of dots</span>
  my.theme</code></pre>
<img src="figure/violin-dotplot-size.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="section-1">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b> Basic Embellishments </b>
</p>

<BR>
<ul style="color: #CCCCCC; font-size:21pt; padding-left:50px">
    <li>
add means to boxplots
</li>
    <li>
add regression lines to scatterplots
</li>
    <li>
annotate plots with text (e.g., regression statistics)
</li>
   </ul> 
</div>
</div>
<div class="section slide level1" id="box-and-scatterplots-revisited">
<h1>Box and scatterplots revisited</h1>
<ul class="incremental">
<li><p>by definition, boxplots display median and interquartile ranges, but not means<br /> – ggplots are built in layers, so it’s easy to add a layer for descriptive statistics like means</p></li>
<li><p>scatterplots display values for multiple continuous variables<br /> – it’s also easy to add a regression line to show direction and size of correlation</p></li>
<li><p>all plots can be annotated with text</p></li>
</ul>
</div>
<div class="section slide level1" id="add-descriptive-stats-to-boxplots">
<h1>Add descriptive stats to boxplots</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg, <span class="dt">group =</span> cyl)) +
  <span class="kw">geom_boxplot</span>() +
  <span class="co"># fun.y=mean calculates the mean of the y-axis variable (mpg) for each group.  </span>
  <span class="co"># geom=&quot;point&quot; indicates means should be plotted as points over top of the boxplots.</span>
  <span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>) +
  my.theme</code></pre>
<img src="figure/boxplot-means.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="scatterplot-with-loess-smoothed-curve-and-labelled-axes">
<h1>Scatterplot with loess-smoothed curve and labelled axes</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() + <span class="co"># make scatterpot</span>
  <span class="kw">geom_smooth</span>() + <span class="co"># add loess line</span>
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) + <span class="co"># change axis labels and limits</span>
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  my.theme</code></pre>
<img src="figure/scatter-loess.png" width="450px" height="325px"  alt="" title="" />
<ul>
  <li> 
by default, error ribbons depict point-wise 95% confidence intervals
</li>
</ul>



</div>
<div class="section slide level1" id="remove-error-ribbon">
<h1>Remove error ribbon</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() + 
  <span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) + <span class="co"># remove error ribbon</span>
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  my.theme</code></pre>
<img src="figure/scatter-noSE.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="change-error-ribbon-to-pointrange">
<h1>Change error ribbon to pointrange</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">stat_smooth</span>(<span class="dt">geom =</span> <span class="st">&quot;pointrange&quot;</span>) + <span class="co"># note the change to stat_smooth()</span>
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  my.theme</code></pre>
<img src="figure/scatter-pointrange.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="plot-a-linear-best-fit-line-instead-of-a-nonlinear-curve">
<h1>Plot a linear best-fit line instead of a nonlinear curve</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y~(x)) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  my.theme</code></pre>
<img src="figure/scatter-regression.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="annotate-the-plot">
<h1>Annotate the plot</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y~(x)) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  <span class="co"># specify the text (i.e., label) and the x- and y-coordinates for text placement</span>
  <span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">250</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span> <span class="st">&quot;R2 = ???, p = ???&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter-annotated-manual.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="the-problem-of-annotating-plots-manually">
<h1>The problem of annotating plots manually…</h1>
<ul class="incremental">
<li><p>if your data set is continually changing (say, as you run more participants), you must continually hand correct the annotations</p></li>
<li><p>this is cumbersome, and it’s easy to make mistakes</p></li>
<li><p><strong>SOLUTION</strong>: supply the <em>label</em> argument with output directly from regression model</p></li>
<li><p>let’s see an example</p></li>
</ul>
</div>
<div class="section slide level1" id="first-examine-the-model-plotted-by-geom_smooth">
<h1>First, examine the model plotted by geom_smooth</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Recall, we had previously specified geom_smooth(method=&#39;lm&#39;, formula=y~(x)).</span>
<span class="co"># The call below produces the same model, just outside of ggplot.</span>
my.model &lt;- <span class="kw">summary</span>(<span class="kw">lm</span>(wt ~ hp, <span class="dt">data =</span> df1))
<span class="kw">print</span>(my.model)</code></pre>
<pre><code>
Call:
lm(formula = wt ~ hp, data = df1)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.4176 -0.5312 -0.0204  0.4254  1.5645 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.83825    0.31652    5.81  2.4e-06 ***
hp           0.00940    0.00196    4.80  4.1e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Residual standard error: 0.748 on 30 degrees of freedom
Multiple R-squared: 0.434,  Adjusted R-squared: 0.415 
F-statistic:   23 on 1 and 30 DF,  p-value: 4.15e-05 
</code></pre>
</div>
<div class="section slide level1" id="next-lets-extract-values-from-this-model">
<h1>Next, let’s extract values from this model</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># extract the R-squared value for the weight~horsepower correlation</span>
my.model.r2 = my.model$r.squared

<span class="kw">print</span>(my.model.r2)</code></pre>
<pre><code>[1] 0.4339</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># combine R-squared value into a descriptive string</span>
my.exp &lt;- <span class="kw">paste</span>(<span class="st">&quot;R2 =&quot;</span>, my.model.r2, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)

<span class="kw">print</span>(my.exp)</code></pre>
<pre><code>[1] &quot;R2 = 0.433948779081183&quot;</code></pre>
</div>
<div class="section slide level1" id="now-annotate-plot-with-this-model-output">
<h1>Now, annotate plot with this model output</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y~(x)) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  <span class="co"># We no longer specify the annotation text locally. </span>
  <span class="co"># The text comes directly from the regression model.</span>
  <span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">250</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span> my.exp, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)+
  my.theme</code></pre>
<img src="figure/scatter_annotated_auto.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="extract-and-format-multiple-values-simultaneously">
<h1>Extract and format multiple values simultaneously</h1>
<pre class="sourceCode r"><code class="sourceCode r">lm_eqn = function(df1){
    m = <span class="kw">lm</span>(wt ~ hp, df1);
    eq &lt;- <span class="kw">substitute</span>(<span class="kw">italic</span>(y) == a + b %.% <span class="kw">italic</span>(x)*<span class="st">&quot;,&quot;</span>
                     
                     <span class="er">~~</span><span class="kw">italic</span>(r)^<span class="dv">2</span>~<span class="st">&quot;=&quot;</span>~r2<span class="er">~~</span><span class="st">&quot;, p &lt; &quot;</span><span class="er">~~</span>p, 
         <span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">format</span>(<span class="kw">coef</span>(m)[<span class="dv">1</span>], <span class="dt">digits =</span> <span class="dv">2</span>),
              <span class="dt">b =</span> <span class="kw">format</span>(<span class="kw">coef</span>(m)[<span class="dv">2</span>], <span class="dt">digits =</span> <span class="dv">2</span>),              
              <span class="dt">r2 =</span> <span class="kw">format</span>(<span class="kw">summary</span>(m)$r.squared, <span class="dt">digits =</span> <span class="dv">3</span>),              
              <span class="dt">p =</span> <span class="kw">format</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(m))[<span class="dv">8</span>], <span class="dt">digits =</span> <span class="dv">3</span>, <span class="dt">scientific=</span><span class="ot">FALSE</span>)             
              ))
    <span class="kw">as.character</span>(<span class="kw">as.expression</span>(eq));                 
}</code></pre>
<p> 
Credit goes to Ramnath Vaidyanathan for this function. Go <a href="http://stackoverflow.com/questions/7549694/ggplot2-adding-regression-line-equation-and-r2-on-graph">here</a> for the original post on StackOverflow.
</p>


</div>
<div class="section slide level1" id="advanced-annotation-strategy">
<h1>Advanced annotation strategy</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> wt)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y~(x)) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;gross horsepower&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;weight (lb/1000&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>)) +
  <span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">250</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span> <span class="kw">lm_eqn</span>(df1), <span class="dt">parse =</span> T, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter_annotated_auto_complex.png" width="450px" height="325px"  alt="" title="" />
</div>
<div class="section slide level1" id="section-2">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b>Grouping and Statistically Transforming Data </b>
</p>

<BR>
<ul style="color: #CCCCCC; font-size:21pt; padding-left:50px">
    <li>
log transformations
</li>
    <li>
add regresssion lines in log space
</li>
    <li>
add separate regression lines for data subsets
</li>
    <li>
histograms, density distributions, and faceting
</li>
   </ul> 
</div>
</div>
<div class="section slide level1" id="lets-use-a-larger-data-set">
<h1>Let’s use a larger data set</h1>
<pre class="sourceCode r"><code class="sourceCode r">df2 &lt;- <span class="kw">subset</span>(diamonds, carat &gt; <span class="fl">0.5</span>)

<span class="kw">head</span>(df2)</code></pre>
<pre><code>   carat       cut color clarity depth table price    x    y    z
91  0.70     Ideal     E     SI1  62.5    57  2757 5.70 5.72 3.57
92  0.86      Fair     E     SI2  55.1    69  2757 6.45 6.33 3.52
93  0.70     Ideal     G     VS2  61.6    56  2757 5.70 5.67 3.50
94  0.71 Very Good     E     VS2  62.4    57  2759 5.68 5.73 3.56
95  0.78 Very Good     G     SI2  63.8    56  2759 5.81 5.85 3.72
96  0.70      Good     E     VS2  57.5    58  2759 5.85 5.90 3.38</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(df2)</code></pre>
<pre><code>[1] 35008</code></pre>
</div>
<div class="section slide level1" id="a-linear-best-fit-line-again">
<h1>A linear best-fit line, again</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;carat&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;price&quot;</span>)+
  my.theme</code></pre>
<img src="figure/scatter-diamonds.png" width="475px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="log-transform-the-x--and-y--scale-system">
<h1>Log transform the x- and y- <font color=blue> scale system </font></h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log10</span>(carat), <span class="dt">y =</span> <span class="kw">log10</span>(price))) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;log10(carat)&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;log10(price)&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter-diamonds-log.png" width="475px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="log-transform-the-x--and-y--coordinate-system">
<h1>Log transform the x- and y- <font color=blue> coordinate system </font></h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;log10(carat)&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;log10(price)&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter-diamonds-logcoord.png" width="475px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="use-color-to-depict-subset-groupings">
<h1>Use color to depict subset groupings</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">colour=</span>cut, <span class="dt">fill=</span>cut)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;log10(carat)&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;log10(price)&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter-diamonds-log-group.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="adjust-the-alpha-transparency-of-points">
<h1>Adjust the alpha transparency of points</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">colour=</span>cut, <span class="dt">fill=</span>cut)) +
  <span class="kw">geom_point</span>(<span class="dt">alpha =</span> .<span class="dv">05</span>) + <span class="co"># number btw 0 (transparent) and 1 (opaque)</span>
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;log10(carat)&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;log10(price)&quot;</span>) +
  my.theme</code></pre>
<img src="figure/scatter-diamonds-alpha.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="reverse-legend-so-order-better-matches-plot">
<h1>Reverse legend so order better matches plot</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">colour=</span>cut, <span class="dt">fill=</span>cut)) +
  <span class="kw">geom_point</span>(<span class="dt">alpha =</span> .<span class="dv">05</span>) +
  <span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
  <span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;log10(carat)&quot;</span>) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;log10(price)&quot;</span>) +
  <span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>), <span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) +
  my.theme</code></pre>
<img src="figure/scatter-diamonds-alpha-rev.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="histogram">
<h1>Histogram</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot number of tokens (counts) that fall within a specific bin</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut, <span class="dt">colour=</span>cut)) +
  <span class="kw">geom_histogram</span>(<span class="dt">alpha=</span>.<span class="dv">8</span>) +
  <span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>), <span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) +
  my.theme</code></pre>
<img src="figure/hist.png" width="590px" height="385px"  alt="" title="" />
</div>
<div class="section slide level1" id="density-distribution">
<h1>Density distribution</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the probability that a variable will take on a given value</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut, <span class="dt">colour=</span>cut)) +
  <span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>) +
  <span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>), <span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>)) +
  my.theme</code></pre>
<img src="figure/density1.png" width="590px" height="385px"  alt="" title="" />
</div>
<div class="section slide level1" id="histogram-overlaid-with-density-distribution">
<h1>Histogram overlaid with density distribution</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the trick here is to change the y-axis for the histrogram</span>
<span class="co"># from counts to probability density</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>price)) +
  <span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">alpha=</span>.<span class="dv">5</span>) +
  <span class="kw">geom_density</span>(<span class="dt">size=</span><span class="fl">1.25</span>) +
  my.theme</code></pre>
<img src="figure/hist-dist.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="adjust-the-bandwidth-for-the-kernel-density-estimation">
<h1>Adjust the bandwidth for the kernel density estimation</h1>
<pre class="sourceCode r"><code class="sourceCode r">

<span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>price)) +
  <span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">alpha=</span>.<span class="dv">5</span>) +
  <span class="kw">geom_density</span>(<span class="dt">size=</span><span class="fl">1.25</span>, <span class="dt">adjust=</span><span class="fl">1.9</span>) +
  my.theme</code></pre>
<img src="figure/hist-density-kernel.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="map-a-color-gradient-to-counts">
<h1>Map a color gradient to counts</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>df2, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>..count..)) +
  <span class="kw">geom_histogram</span>() +
  <span class="kw">scale_fill_continuous</span>(<span class="dt">low=</span><span class="st">&quot;violet&quot;</span>, <span class="dt">high=</span><span class="st">&quot;violetred4&quot;</span>) +
  my.theme</code></pre>
<img src="figure/hist-gradient.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="histograms-split-by-variable">
<h1>Histograms split by variable</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define subset for easy reference</span>
df2.sub &lt;- <span class="kw">subset</span>(df2, cut %in% <span class="kw">c</span>(<span class="st">&quot;Ideal&quot;</span>,<span class="st">&quot;Good&quot;</span>) &amp; price &lt; <span class="dv">8000</span>)

<span class="kw">ggplot</span>(<span class="dt">data=</span>df2.sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">colour=</span>cut)) +
  <span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut), <span class="dt">alpha=</span>.<span class="dv">3</span>) +
  <span class="kw">geom_density</span>(<span class="dt">size=</span><span class="fl">1.5</span>) +
  <span class="kw">facet_grid</span>(cut ~ .) +
  my.theme</code></pre>
<img src="figure/density-dist.png" width="590px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="embellish-histograms">
<h1>Embellish histograms</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate means of each group</span>
df2.sub.means &lt;- <span class="kw">ddply</span>(df2.sub, .(cut), 
                   summarise, <span class="dt">mean.price=</span><span class="kw">mean</span>(price))</code></pre>
<pre><code>Error: could not find function &quot;ddply&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(df2.sub.means)</code></pre>
<pre><code>Error: object &#39;df2.sub.means&#39; not found</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(<span class="dt">data=</span>df2.sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">colour=</span>cut)) +
  <span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut), <span class="dt">alpha=</span>.<span class="dv">3</span>) +
  <span class="kw">geom_density</span>(<span class="dt">size=</span><span class="fl">1.5</span>) +
  <span class="kw">geom_vline</span>(<span class="dt">data=</span>df2.sub.means, <span class="kw">aes</span>(<span class="dt">xintercept=</span>mean.price),
             <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) + <span class="co"># add means as dashed lines</span>
  <span class="kw">facet_grid</span>(cut ~ .) + <span class="co"># plot subgroups as separate &quot;facets&quot;</span>
  my.theme</code></pre>
<pre><code>Error: object &#39;df2.sub.means&#39; not found</code></pre>
</div>
<div class="section slide level1" id="section-3">

<div style="background: linear-gradient(#252525, #727272); 
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b>Some Cosmetic Details </b>
</p> 
 
<BR>
<ul style="color: #CCCCCC; font-size:21pt; padding-left:50px">
    <li> 
using colo(u)r in plots
</li>
    <li> 
control legend and axis formatting
</li>
   </ul>  
</div>
</div>
<div class="section slide level1" id="color-palettes">
<h1>Color palettes</h1>
<img src="figure/colorwheel.png" width="800px" height="650px"  alt="plot of chunk colorwheel" title="plot of chunk colorwheel" />
</div>
<div class="section slide level1" id="ggplot-color-selection-maximal-dispersion">
<h1>ggplot color selection – maximal dispersion</h1>
<img src="figure/colors.png" width="800px" height="650px"  alt="plot of chunk colors" title="plot of chunk colors" />
</div>
<div class="section slide level1" id="number-of-factor-levels-determines-colors">
<h1>Number of factor levels determines colors</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  my.theme</code></pre>
<img src="figure/colors-bars1.png" width="475px" height="355px"  alt="plot of chunk colors-bars" title="plot of chunk colors-bars" />
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="dt">x =</span> trans, <span class="dt">fill =</span> trans)) + 
  <span class="kw">geom_bar</span>() +
  my.theme</code></pre>
<img src="figure/colors-bars2.png" width="475px" height="355px"  alt="plot of chunk colors-bars" title="plot of chunk colors-bars" />
</div>
<div class="section slide level1" id="change-color-palette-using-color-names">
<h1>Change color palette using color names</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)) +
  my.theme</code></pre>
<img src="figure/colors-bars-custom.png" width="475px" height="355px"  alt="plot of chunk colors-bars-custom" title="plot of chunk colors-bars-custom" />
</div>
<div class="section slide level1" id="change-color-palette-using-hexidecimal-notation">
<h1>Change color palette using hexidecimal notation</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#980000&quot;</span>, <span class="st">&quot;#009800&quot;</span>, <span class="st">&quot;#000098&quot;</span>)) +
  my.theme</code></pre>
<img src="figure/colors-bars-customhex.png" width="475px" height="355px"  alt="plot of chunk colors-bars-customhex" title="plot of chunk colors-bars-customhex" />
</div>
<div class="section slide level1" id="use-pre-defined-palette-from-rcolorbrewer">
<h1>Use pre-defined palette from RColorBrewer</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_brewer</span>() +
  my.theme</code></pre>
<img src="figure/colors-bars-brewer.png" width="475px" height="355px"  alt="plot of chunk colors-bars-brewer" title="plot of chunk colors-bars-brewer" />
</div>
<div class="section slide level1" id="rcolorbrewer-has-many-pre-defined-palettes">
<h1>RColorBrewer has many pre-defined palettes</h1>
<div class="figure">
<img src="http://www.datavis.ca/sasmac/brewer.all.jpg" alt="brewer" /><p class="caption">brewer</p>
</div>
</div>
<div class="section slide level1" id="select-specific-palette-from-rcolorbrewer">
<h1>Select specific palette from RColorBrewer</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;YlOrRd&quot;</span>)+
  my.theme</code></pre>
<img src="figure/colors-bars-brewer2.png" width="475px" height="355px"  alt="plot of chunk colors-bars-brewer2" title="plot of chunk colors-bars-brewer2" />
</div>
<div class="section slide level1" id="render-image-in-grayscale">
<h1>Render image in grayscale</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_grey</span>() +
  my.theme</code></pre>
<img src="figure/colors-bars-gray.png" width="475px" height="355px"  alt="plot of chunk colors-bars-gray" title="plot of chunk colors-bars-gray" />
</div>
<div class="section slide level1" id="change-legend-name">
<h1>Change legend name</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_grey</span>(<span class="st">&quot;Cylinders&quot;</span>) +
  my.theme</code></pre>
<img src="figure/colors-bars-legendname.png" width="475px" height="355px"  alt="plot of chunk colors-bars-legendname" title="plot of chunk colors-bars-legendname" />
</div>
<div class="section slide level1" id="every-element-in-a-plot-is-customizable">
<h1>Every element in a plot is customizable</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(cyl), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) + 
  <span class="kw">geom_bar</span>() +
  <span class="kw">scale_fill_grey</span>(<span class="st">&quot;Cylinders&quot;</span>) +
  <span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>,              <span class="co"># move legend below x-axis</span>
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">face=</span><span class="st">&quot;italic&quot;</span>, <span class="dt">size=</span><span class="dv">19</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">17</span>), 
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">17</span>),
        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),        <span class="co"># remove x-axis label</span>
        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),     <span class="co"># remove panel grid</span>
        <span class="dt">axis.line =</span> <span class="kw">element_line</span>()  <span class="co"># add &#39;l-shaped&#39; axis line</span>
        ) </code></pre>
<img src="figure/colors-bars-cosmetic.png" width="475px" height="355px"  alt="plot of chunk colors-bars-cosmetic" title="plot of chunk colors-bars-cosmetic" />
</div>
<div class="section slide level1" id="section-4">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b> Linguistic Data </b>
</p> 
<p align="center" style="font-family: Palatino; color:#CCCCCC; font-size:24pt"> 
  
Part 1: Formant Values and Vowel Plots
</p> 
</div>
</div>
<div class="section slide level1" id="peterson-and-barney-1952-vowel-data">
<h1>Peterson and Barney (1952) vowel data</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># acoustic measurements of 8 reps of 10 vowels from 72 speakers (adults and</span>
<span class="co"># children)</span>
pb &lt;- <span class="kw">read.delim</span>(<span class="st">&quot;http://ling.upenn.edu/courses/cogs501/pb.Table1&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)

<span class="co"># Give meaningful column names</span>
<span class="kw">colnames</span>(pb) &lt;- <span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Speaker&quot;</span>, <span class="st">&quot;Vowel&quot;</span>, <span class="st">&quot;V1&quot;</span>, <span class="st">&quot;F0.hz&quot;</span>, <span class="st">&quot;F1.hz&quot;</span>, <span class="st">&quot;F2.hz&quot;</span>, 
    <span class="st">&quot;F3.hz&quot;</span>)

<span class="co"># Relabel the age data</span>
<span class="kw">levels</span>(pb$Age) &lt;- <span class="kw">c</span>(<span class="st">&quot;Child&quot;</span>, <span class="st">&quot;Adult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)
pb$Age &lt;- <span class="kw">relevel</span>(pb$Age, <span class="st">&quot;Adult&quot;</span>)

<span class="co"># Clean up speaker labeling</span>
pb$Speaker &lt;- <span class="kw">as.factor</span>(<span class="kw">paste</span>(<span class="st">&quot;S&quot;</span>, pb$Speaker, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))

<span class="kw">head</span>(pb)</code></pre>
<pre><code>    Age Sex Speaker Vowel   V1 F0.hz F1.hz F2.hz F3.hz
1 Adult   m      S1    iy    i   160   240  2280  2850
2 Adult   m      S1    iy    i   186   280  2400  2790
3 Adult   m      S1    ih \\ic   203   390  2030  2640
4 Adult   m      S1    ih \\ic   192   310  1980  2550
5 Adult   m      S1    eh \\ep   161   490  1870  2420
6 Adult   m      S1    eh \\ep   155   570  1700  2600</code></pre>
</div>
<div class="section slide level1" id="a-vowel-plot-of-one-speakers-data">
<h1>A vowel plot of one speaker’s data</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note we can select a subset from within the call to ggplot</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(pb, Speaker==<span class="st">&quot;S2&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_text</span>() +  <span class="co"># geom_text() labels points. Label must be specified as an aesthetic</span>
  <span class="kw">scale_y_reverse</span>() +   <span class="co"># reverse the axes</span>
  <span class="kw">scale_x_reverse</span>() +
  my.theme</code></pre>
<img src="figure/vowelplot_S2.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="label-placement-was-bad-on-that-last-one.-lets-fix-it">
<h1>Label placement was bad on that last one. Let’s fix it!</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note we can select a subset from within the call to ggplot</span>
<span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(pb, Speaker==<span class="st">&quot;S2&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_text</span>(<span class="dt">hjust=</span><span class="fl">1.1</span>, <span class="dt">vjust=</span>-.<span class="dv">2</span>, <span class="dt">size=</span><span class="fl">5.5</span>) + <span class="co"># adjust placement and size of labels</span>
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  my.theme</code></pre>
<img src="figure/vowelplot_S2_fixed.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="plot-multiple-speakers-individually">
<h1>Plot multiple speakers individually</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(pb, Speaker %in% <span class="kw">c</span>(<span class="st">&quot;S1&quot;</span>,<span class="st">&quot;S2&quot;</span>,<span class="st">&quot;S3&quot;</span>,<span class="st">&quot;S4&quot;</span>)), <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel)) +
  <span class="kw">geom_text</span>(<span class="dt">hjust=</span><span class="dv">1</span>, <span class="dt">vjust=</span>-.<span class="dv">2</span>) + 
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  <span class="kw">facet_wrap</span>(~ Speaker) + <span class="co"># this line provides functionality similar to the lattice package</span>
  my.theme</code></pre>
<img src="figure/vowelplot_faceted.png" width="550px" height="425px"  alt="" title="" />
</div>
<div class="section slide level1" id="more-complex-faceting">
<h1>More complex faceting</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>pb, <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel, <span class="dt">colour=</span>Vowel)) +
  <span class="kw">geom_text</span>(<span class="dt">hjust=</span><span class="dv">1</span>, <span class="dt">vjust=</span>-.<span class="dv">2</span>) + 
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  <span class="kw">facet_wrap</span>(~ Sex + Age) + <span class="co"># specify multiple variables for faceting</span>
  my.theme</code></pre>
<img src="figure/vowelplot_faceted-complex.png" width="540px" height="360px"  alt="" title="" />
<p>Note: some male-adult values are being cut off</p>
</div>
<div class="section slide level1" id="adjust-range-of-reversed-axes">
<h1>Adjust range of reversed axes</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>pb, <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel, <span class="dt">colour=</span>Vowel)) +
  <span class="kw">geom_text</span>(<span class="dt">hjust=</span><span class="dv">1</span>, <span class="dt">vjust=</span>-.<span class="dv">2</span>) + 
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  <span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>)) +
  <span class="kw">facet_wrap</span>(~ Sex + Age) +
  my.theme</code></pre>
<img src="figure/vowelplot_faceted-axes.png" width="540px" height="360px"  alt="" title="" />
<p>
There are many ways to adjust axis limits, but when axes are reversed, it’s best to use <b>coord_cartesian()</b>
</p>

</div>
<div class="section slide level1" id="plot-all-females-by-age">
<h1>Plot all females by age</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(pb, Sex==<span class="st">&quot;f&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel, <span class="dt">colour=</span>Age)) +
  <span class="kw">geom_text</span>() +
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  my.theme</code></pre>
<img src="figure/vowelplot_NOchull.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="wouldnt-it-be-cool-if">
<h1>Wouldn’t it be cool if…</h1>
<ul class="incremental">
<li><p>… we could plot shaded regions showing the total area of the child’s formant space vs. the adult’s space?</p></li>
<li><p>as it turns out, <strong>geom_polygon</strong> can do just that</p></li>
<li><p>first, we just need to find the envelope (i.e., convex hull) for adults and children</p></li>
</ul>
</div>
<div class="section slide level1" id="convex-hulls">
<h1>Convex hulls</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(plyr)
<span class="co"># chull() is a function for finding the &#39;envelope&#39; of a set of data points.</span>
<span class="co"># Here we use this function to find the extreme points for a 2-dimensional</span>
<span class="co"># space (F1-F2)</span>
find_hull &lt;- function(df) {
    df[<span class="kw">chull</span>(df$F2.hz, df$F1.hz), ]
}

<span class="co"># apply this function to find the envelope for females by Age (adult vs.</span>
<span class="co"># children)</span>
hulls &lt;- <span class="kw">ddply</span>(<span class="kw">subset</span>(pb, Sex == <span class="st">&quot;f&quot;</span>), .(Age), find_hull)

<span class="kw">print</span>(hulls)</code></pre>
<pre><code>     Age Sex Speaker Vowel   V1 F0.hz F1.hz F2.hz F3.hz
1  Adult   f     S54    iy    i   220   220  2850  3800
2  Adult   f     S37    ah \\vt   213   280   850  2500
3  Adult   f     S61    ah \\vt   260   290   670  2380
4  Adult   f     S61    ah \\vt   275   330   630  2460
5  Adult   f     S59    uh \\hs   246   420   590  3100
6  Adult   f     S58    ao \\ct   250   950  1130  3160
7  Adult   f     S53    ao \\ct   267   987  1172  3180
8  Adult   f     S40    ao \\ct   180  1040  1300  3000
9  Adult   f     S48    ae \\ae   222  1110  2160  2700
10 Adult   f     S40    iy    i   200   300  3100  3400
11 Child   f     S63    iy    i   290   320  3500  4260
12 Child   f     S68    ah \\vt   260   310   730  3500
13 Child   f     S68    ah \\vt   274   360   660  3050
14 Child   f     S62    ah \\vt   200   400   650  3800
15 Child   f     S66    uh \\hs   285   770   940  3750
16 Child   f     S76    ao \\ct   350  1190  1470  3150
17 Child   f     S62    ao \\ct   200  1300  1800  3450
18 Child   f     S67    ae \\ae   214  1240  2700  3640
19 Child   f     S67    iy    i   227   590  3610  4220</code></pre>
</div>
<div class="section slide level1" id="using-convex-hulls-in-plots">
<h1>Using convex hulls in plots</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(pb, Sex==<span class="st">&quot;f&quot;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>F2.hz, <span class="dt">y=</span>F1.hz, <span class="dt">label=</span>Vowel, <span class="dt">colour=</span>Age, <span class="dt">fill=</span>Age)) +  
  <span class="kw">geom_text</span>() +
  <span class="kw">geom_polygon</span>(<span class="dt">data=</span>hulls, <span class="dt">alpha=</span>.<span class="dv">4</span>) +
  <span class="kw">scale_y_reverse</span>() +
  <span class="kw">scale_x_reverse</span>() +
  my.theme</code></pre>
<img src="figure/vowelplot_chull.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="section-5">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
<b>Linguistic Data </b>
</p> 
<p align="center" style="font-family: Palatino; color:#CCCCCC; font-size:24pt"> 
  
Part 2: Response Times, Barplots, and Error Bars
</p> 
</div>
</div>
<div class="section slide level1" id="a-conceptual-overview-for">
<h1>A conceptual overview for…</h1>
<br>
<ul>
  <li> 
… plotting mean RTs with error bars showing standard error of the mean
</li>
    <ol>
      <li> 
calculate mean RT for each condition for each subject
</li>
      <li> 
calculate condition grand mean RTs by averaging over subject-wise means
</li>
      <li> 
calculate std.error over subject-wise means, resulting in <b> standard error of the mean</b>
</li>
      <li> 
then plot (2) and (3) using <b>geom_bar()</b> and <b>geom_errorbar()</b>
</li>
    </ol>
<br>
</ul>


</div>
<div class="section slide level1" id="one-way-to-calculate-standard-error-of-the-mean">
<h1>One way to calculate standard error of the mean</h1>
<BR>
<p> 
standard error of the mean equals std. deviation (\(\sigma\)) divided by the square root of the sample size (N)
</p>
  
<p>\[ SE_{\bar{x}} = \sigma / \sqrt{N} \]</p>
<p> 
which is equivalent to square root of variance (\(s^2\)) divided by square root of sample size (N)
</p>
  
<p>\[ \sqrt{s^2 / N} \]</p>
<pre class="sourceCode r"><code class="sourceCode r">std.error &lt;- function(x, <span class="dt">na.rm =</span> T) {
    <span class="kw">sqrt</span>(<span class="kw">var</span>(x, <span class="dt">na.rm =</span> na.rm)/<span class="kw">length</span>(x[<span class="kw">complete.cases</span>(x)]))
}</code></pre>
</div>
<div class="section slide level1" id="a-fake-data-set">
<h1>A fake data set</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read in fake data</span>
rt.dat &lt;- <span class="kw">read.delim</span>(<span class="st">&quot;datasets/fakedata.txt&quot;</span>, <span class="dt">header =</span> T)

<span class="kw">head</span>(rt.dat)</code></pre>
<pre><code>  Subject Item IV1 IV2 Response Freq   RT
1      S1 t_01   A   2        1 0.24 1100
2      S1 t_02   A   2        1 5.22  983
3      S1 t_03   A   2        1 5.10 1108
4      S1 t_04   A   2        1 5.77  984
5      S1 t_05   A   2        1 2.37 1340
6      S1 t_06   A   2        1 5.80 1192</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># How many data points per subjet per condition</span>
<span class="kw">table</span>(rt.dat$IV1, rt.dat$IV2)/<span class="kw">length</span>(<span class="kw">unique</span>(rt.dat$Subject))</code></pre>
<pre><code>   
    2 3 4
  A 8 8 8
  B 8 8 8</code></pre>
</div>
<div class="section slide level1" id="calculate-subject-wise-condition-means">
<h1>Calculate subject-wise condition means</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(plyr)

<span class="co"># use ddply() to calculate condition means for each subject, averaging over items</span>
mean.bySubj &lt;- <span class="kw">ddply</span>(rt.dat, .(Subject, IV1, IV2), summarise, 
                     <span class="st">&quot;mean.RT&quot;</span> = <span class="kw">mean</span>(RT))

<span class="kw">head</span>(mean.bySubj, <span class="dv">18</span>)</code></pre>
<pre><code>   Subject IV1 IV2 mean.RT
1       S1   A   2    1150
2       S1   A   3    1309
3       S1   A   4    1453
4       S1   B   2    1067
5       S1   B   3    1479
6       S1   B   4    1694
7      S10   A   2    1245
8      S10   A   3    1318
9      S10   A   4    1636
10     S10   B   2    1136
11     S10   B   3    1467
12     S10   B   4    1914
13     S11   A   2    1234
14     S11   A   3    1418
15     S11   A   4    1679
16     S11   B   2    1102
17     S11   B   3    1435
18     S11   B   4    1894</code></pre>
</div>
<div class="section slide level1" id="calculate-grand-means-and-std.error-of-the-mean">
<h1>Calculate grand means and std.error of the mean</h1>
<pre class="sourceCode r"><code class="sourceCode r">grand.means &lt;- <span class="kw">ddply</span>(mean.bySubj, .(IV1, IV2), summarise, 
                     <span class="st">&quot;grand.RT&quot;</span> = <span class="kw">mean</span>(mean.RT), 
                     <span class="st">&quot;se&quot;</span> = <span class="kw">std.error</span>(mean.RT))

<span class="kw">print</span>(grand.means)</code></pre>
<pre><code>  IV1 IV2 grand.RT    se
1   A   2    713.9 76.75
2   A   3    885.9 76.33
3   A   4   1152.3 77.98
4   B   2    721.9 74.06
5   B   3   1019.1 81.86
6   B   4   1445.9 77.44</code></pre>
</div>
<div class="section slide level1" id="bar-plot-showing-group-means-and-standard-error">
<h1>Bar plot showing group means and standard error</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> grand.means, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(IV2), <span class="dt">y =</span> grand.RT, <span class="dt">fill =</span> IV1)) +
  <span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>)) + <span class="co"># position bars side-by-side (cf. stacked)</span>
  <span class="kw">geom_errorbar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>), <span class="dt">width =</span> .<span class="dv">25</span>, 
                <span class="kw">aes</span>(<span class="dt">ymin =</span> grand.RT-se, <span class="dt">ymax =</span> grand.RT+se)) + <span class="co"># ymax and ymin are group mean +/- std. error</span>
  my.theme</code></pre>
<img src="figure/bars.png" width="575px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="if-x-axis-levels-are-meaningfully-related-try-a-line-graph">
<h1>If x-axis levels are meaningfully related, try a line graph</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> grand.means, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(IV2), <span class="dt">y=</span>grand.RT, <span class="dt">group=</span>IV1, <span class="dt">colour=</span>IV1)) +
  <span class="kw">geom_point</span>() + <span class="co"># use points and lines instead of geom_bar()</span>
  <span class="kw">geom_line</span>() +
  <span class="co"># note: we no longer need to specify position_dodge for the errorbars</span>
  <span class="kw">geom_errorbar</span>(<span class="dt">width =</span> .<span class="dv">15</span>, <span class="kw">aes</span>(<span class="dt">ymin =</span> grand.RT-se, <span class="dt">ymax =</span> grand.RT+se)) +
  my.theme</code></pre>
<img src="figure/line-error.png" width="575px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="change-linetype">
<h1>Change linetype</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> grand.means, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(IV2), <span class="dt">y=</span>grand.RT, <span class="dt">group=</span>IV1, <span class="dt">colour=</span>IV1)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_line</span>(<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>) +
  <span class="kw">geom_errorbar</span>(<span class="dt">width =</span> .<span class="dv">15</span>, <span class="kw">aes</span>(<span class="dt">ymin =</span> grand.RT-se, <span class="dt">ymax =</span> grand.RT+se)) +
  my.theme</code></pre>
<img src="figure/line-error-dashed.png" width="575px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="a-brief-digression-or-why-averaging-over-subjects-is-crucial-a-story-in-two-parts">
<h1>A Brief Digression – Or, Why Averaging over Subjects is Crucial: A Story in Two Parts</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># immediately calculate condition means and error from raw data,   </span>
<span class="co"># without first averaging over subjs    </span>
means.wrong &lt;- <span class="kw">ddply</span>(rt.dat, .(IV1, IV2), summarise, <span class="st">&quot;mean.RT&quot;</span> = <span class="kw">mean</span>(RT))
error.wrong &lt;- <span class="kw">ddply</span>(rt.dat, .(IV1,IV2), summarise, <span class="st">&quot;se&quot;</span> = <span class="kw">std.error</span>(RT))

<span class="co"># merge means and error into one frame  </span>
wrong.grand &lt;- <span class="kw">merge</span>(means.wrong, error.wrong, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;IV1&quot;</span>, <span class="st">&quot;IV2&quot;</span>), <span class="dt">all=</span>T)

<span class="kw">print</span>(wrong.grand)</code></pre>
<pre><code>  IV1 IV2 mean.RT    se
1   A   2   713.9 28.56
2   A   3   885.9 29.06
3   A   4  1152.3 30.37
4   B   2   721.9 27.55
5   B   3  1019.1 31.51
6   B   4  1445.9 32.02</code></pre>
<ul class="incremental">
<li>now let’s visually compare these error values to the previously calculated standard error of the mean</li>
</ul>
</div>
<div class="section slide level1" id="why-averaging-over-subjects-is-crucial-contd.">
<h1>Why averaging over subjects is crucial, cont’d.</h1>
<img src="figure/wrong-means-contd.png" width="875px" height="500px"  alt="" title="" />
</div>
<div class="section slide level1" id="what-happened">
<h1>What happened?</h1>
<ul class="incremental">
<li><p>The error bars became substantially smaller. Why?</p></li>
<li><p>Recall that when calculating standard error of the mean correctly, the denominator is the sample size of the data set (e.g., number of participants)</p></li>
<li><p>Hence, we want to calculate error using a data frame containing one data point per subject per condition (i.e., each subject’s mean performance in that condition)</p></li>
<li><p>If we calculate standard error over the whole data set (as in the second example above), instead of over subject means, then the denominator is huge! Which leads to a tiny error measurement.</p></li>
</ul>
</div>
<div class="section slide level1" id="section-6">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
</b>Linguistic Data </b>
</p> 
<p align="center" style="font-family: Palatino; color:#CCCCCC; font-size:24pt"> 
  
Part 3: Binomial DVs and Proportions
</p> 
</div>
</div>
<div class="section slide level1" id="the-lexdec-data-set">
<h1>The lexdec data set</h1>
<pre class="sourceCode r"><code class="sourceCode r">## lexdec is a canned lexical decision data set from Harold Baayen and Jen Hay
## available in the package languageR

<span class="co"># install.packages(&#39;languageR&#39;)</span>
<span class="kw">require</span>(languageR)

<span class="co"># numeric coding of of whether response was correct or incorrect</span>
lexdec$Correct.num &lt;- <span class="kw">ifelse</span>(lexdec$Correct == <span class="st">&quot;correct&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)

<span class="co"># simplify column names</span>
<span class="kw">colnames</span>(lexdec)[<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)] &lt;- <span class="kw">c</span>(<span class="st">&quot;NativeLang&quot;</span>, <span class="st">&quot;Freq&quot;</span>)

<span class="co"># select specific subset for illustrative purposes</span>
subjs &lt;- <span class="kw">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;R3&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;T1&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;M2&quot;</span>, <span class="st">&quot;T2&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;Z&quot;</span>)
lex.sub &lt;- <span class="kw">subset</span>(lexdec, Subject %in% subjs)

<span class="kw">str</span>(lex.sub)</code></pre>
<pre><code>&#39;data.frame&#39;:   948 obs. of  29 variables:
 $ Subject     : Factor w/ 21 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
 $ RT          : num  6.34 6.31 6.35 6.19 6.03 ...
 $ Trial       : int  23 27 29 30 32 33 34 38 41 42 ...
 $ Sex         : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ NativeLang  : Factor w/ 2 levels &quot;English&quot;,&quot;Other&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ Correct     : Factor w/ 2 levels &quot;correct&quot;,&quot;incorrect&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ PrevType    : Factor w/ 2 levels &quot;nonword&quot;,&quot;word&quot;: 2 1 1 2 1 2 2 1 1 2 ...
 $ PrevCorrect : Factor w/ 2 levels &quot;correct&quot;,&quot;incorrect&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ Word        : Factor w/ 79 levels &quot;almond&quot;,&quot;ant&quot;,..: 55 47 20 58 25 12 71 69 62 1 ...
 $ Freq        : num  4.86 4.61 5 4.73 7.67 ...
 $ FamilySize  : num  1.386 1.099 0.693 0 3.135 ...
 $ SynsetCount : num  0.693 1.946 1.609 1.099 2.079 ...
 $ Length      : int  3 4 6 4 3 10 10 8 6 6 ...
 $ Class       : Factor w/ 2 levels &quot;animal&quot;,&quot;plant&quot;: 1 1 2 2 1 2 2 1 2 2 ...
 $ FreqSingular: int  54 69 83 44 1233 26 50 63 11 24 ...
 $ FreqPlural  : int  74 30 49 68 828 31 65 47 9 42 ...
 $ DerivEntropy: num  0.791 0.697 0.475 0 1.213 ...
 $ Complex     : Factor w/ 2 levels &quot;complex&quot;,&quot;simplex&quot;: 2 2 2 2 2 1 1 2 2 2 ...
 $ rInfl       : num  -0.31 0.815 0.519 -0.427 0.398 ...
 $ meanRT      : num  6.36 6.42 6.34 6.34 6.3 ...
 $ SubjFreq    : num  3.12 2.4 3.88 4.52 6.04 3.28 5.04 2.8 3.12 3.72 ...
 $ meanSize    : num  3.48 3 1.63 1.99 4.64 ...
 $ meanWeight  : num  3.18 2.61 1.21 1.61 4.52 ...
 $ BNCw        : num  12.06 5.74 5.72 2.05 74.84 ...
 $ BNCc        : num  0 4.06 3.25 1.46 50.86 ...
 $ BNCd        : num  6.18 2.85 12.59 7.36 241.56 ...
 $ BNCcRatio   : num  0 0.708 0.568 0.713 0.68 ...
 $ BNCdRatio   : num  0.512 0.497 2.202 3.591 3.228 ...
 $ Correct.num : num  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="section slide level1" id="simple-research-questions-with-this-data-set">
<h1>Simple research questions with this data set</h1>
<BR>
<ol>
  <li> 
Does accuracy (i.e., proportion of correct responses) vary as a function of word frequency?
</li>
  
<br>
<li>  
Does word frequency interact with participant’s native language?
</li>
 </ol>


</div>
<div class="section slide level1" id="accuracy-by-word-freq-and-subjects-native-language">
<h1>Accuracy by word freq and subject’s native language</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> lex.sub, <span class="kw">aes</span>(<span class="dt">x=</span>Freq, <span class="dt">y=</span>Correct.num, <span class="dt">colour=</span>NativeLang, <span class="dt">fill=</span>NativeLang)) +
  <span class="kw">geom_point</span>() +
  <span class="co"># fit data with a logistic regression line</span>
  <span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="dt">formula=</span>y~(x)) +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;Proportion correct&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;Word Frequency&quot;</span>) +
  my.theme</code></pre>
<img src="figure/lexdec2.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="when-logistic-regression-isnt-specified-in-the-smoother">
<h1>When logistic regression isn’t specified in the smoother</h1>
<ul>
  <li>
geom_smooth defaults to fitting with a loess smoother
</li>
  <li> 
and confidence interval estimation can exceed bounded range of 0-1
</li>
</ul>


<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> lex.sub, <span class="kw">aes</span>(<span class="dt">x=</span>Freq, <span class="dt">y=</span>Correct.num, <span class="dt">colour=</span>NativeLang, <span class="dt">fill=</span>NativeLang)) +
  <span class="kw">geom_point</span>() +
  <span class="kw">geom_smooth</span>() +
  <span class="kw">scale_y_continuous</span>(<span class="st">&quot;Proportion correct&quot;</span>) +
  <span class="kw">scale_x_continuous</span>(<span class="st">&quot;Word Frequency&quot;</span>) +
  my.theme</code></pre>
<img src="figure/lexdec.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="other-research-questions">
<h1>Other research questions</h1>
<BR>
<ul>
  <li> 
The previous questions involved a continuous variable.
</li>
  
<br>
<li> 
What if we’re dealing only with factors and need to calculate proportions over factor levels. For example, if we have the folowing research questions:
</li>
    <ol>
      <li> 
Does accuracy vary depending on whether the previous trial was a word or non-word?
</li>
      
<br>
<li>  
Does previous type interact with participant’s native language?
</li>
 </ol>
</ul>


</div>
<div class="section slide level1" id="subject-wise-proportions-for-factors">
<h1>Subject-wise proportions for factors</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate proportion correct for each subject as a function of whether the</span>
<span class="co"># previous type was a word or nonword</span>
props.bySubj &lt;- <span class="kw">ddply</span>(lex.sub, .(Subject, NativeLang, PrevType), function(x) {
    <span class="kw">sum</span>(x$Correct.num)/<span class="kw">nrow</span>(x)
})

<span class="co"># change name of the proportion columns</span>
<span class="kw">names</span>(props.bySubj)[<span class="kw">names</span>(props.bySubj) == <span class="st">&quot;V1&quot;</span>] &lt;- <span class="st">&quot;Prop&quot;</span>

<span class="kw">print</span>(props.bySubj)</code></pre>
<pre><code>   Subject NativeLang PrevType   Prop
1       A1    English  nonword 0.9767
2       A1    English     word 1.0000
3       A2    English  nonword 0.9487
4       A2    English     word 0.9750
5        C    English  nonword 1.0000
6        C    English     word 0.9722
7        J      Other  nonword 0.8667
8        J      Other     word 0.8235
9        K    English  nonword 1.0000
10       K    English     word 0.8537
11      M2      Other  nonword 0.9444
12      M2      Other     word 0.9535
13      R3    English  nonword 0.9750
14      R3    English     word 0.9744
15       S    English  nonword 0.9750
16       S    English     word 1.0000
17      T1    English  nonword 0.9487
18      T1    English     word 0.9750
19      T2      Other  nonword 0.9048
20      T2      Other     word 0.9189
21       V      Other  nonword 0.9773
22       V      Other     word 0.9429
23       Z      Other  nonword 0.9111
24       Z      Other     word 0.9118</code></pre>
</div>
<div class="section slide level1" id="bootstrapped-confidence-intervals">
<h1>Bootstrapped confidence intervals</h1>
<ul>
  <li> 
given the subject-wise proportions we just calculated, ggplot can calculate grand mean proportions and plot bootstrapped (non-parametric) 95% confidence intervals
</li>
</ul>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> props.bySubj, <span class="kw">aes</span>(<span class="dt">x =</span> PrevType, <span class="dt">y =</span> Prop, <span class="dt">colour =</span> NativeLang)) +
  <span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">size =</span> <span class="fl">1.4</span>) +
  my.theme</code></pre>
<img src="figure/boostrapped-conf-int.png" width="450px" height="355px"  alt="" title="" />
<ul>
  <li> 
note: the y-axis range defaults to the plotting range, not the 0-to-1 proportion space
</li>
</ul>



</div>
<div class="section slide level1" id="barplot-with-ootstrapped-confidence-intervals">
<h1>Barplot with ootstrapped confidence intervals</h1>
<ul>
  <li> 
given the subject-wise proportions we just calculated, ggplot can calculate grand mean proportions and plot bootstrapped (non-parametric) 95% confidence intervals
</li>
</ul>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> props.bySubj, <span class="kw">aes</span>(<span class="dt">x =</span> PrevType, <span class="dt">y =</span> Prop, <span class="dt">fill =</span> NativeLang)) +
  <span class="kw">stat_summary</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>), <span class="dt">fun.y=</span>mean, <span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>) +
  <span class="kw">stat_summary</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>), <span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;errorbar&quot;</span>, <span class="dt">width=</span>.<span class="dv">25</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) +
  my.theme</code></pre>
<img src="figure/bar-boostrapped.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="an-alternate-approach">
<h1>An alternate approach</h1>
<br>
<ul>
  <li> 
if you want a dataframe containing the grand mean proportions and some measure of variability, calculate these values manually instead of using the bootstrapped method
</li>
  
<br>
<li> 
this approach is just like we saw for RTs earlier
</li>
    <ol>
      <li> 
calculate mean proportion for each condition for each subject
</li>
      <li> 
calculate condition grand means by averaging over subject-wise proportions
</li>
      <li> 
calculate std.error (or CIs) over subject-wise proportions, resulting in <b> standard error of the mean</b>
</li>
      <li> 
then plot (2) and (3) using <b>geom_bar()</b> and <b>geom_errorbar()</b>
</li>
    </ol>
<br>
</ul>

<ul class="incremental">
<li>we’ve already done step (1), so let’s proceed to steps (2) and (3)</li>
</ul>
</div>
<div class="section slide level1" id="grand-mean-proportion-and-se-over-subject-means">
<h1>Grand mean proportion and se over subject means</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate grand mean and standard error by native language and previous word</span>
<span class="co"># type</span>
grand.props &lt;- <span class="kw">ddply</span>(props.bySubj, .(NativeLang, PrevType), summarise, <span class="dt">mean.prop =</span> <span class="kw">mean</span>(Prop), 
    <span class="dt">se =</span> <span class="kw">std.error</span>(Prop))

<span class="kw">print</span>(grand.props)</code></pre>
<pre><code>  NativeLang PrevType mean.prop      se
1    English  nonword    0.9749 0.00792
2    English     word    0.9643 0.01901
3      Other  nonword    0.9209 0.01875
4      Other     word    0.9101 0.02295</code></pre>
</div>
<div class="section slide level1" id="barplot-of-proportions">
<h1>Barplot of proportions</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> grand.props, <span class="kw">aes</span>(<span class="dt">x =</span> PrevType, <span class="dt">y =</span> mean.prop, <span class="dt">fill =</span> NativeLang)) +
  <span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>)) +
  <span class="kw">geom_errorbar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>), <span class="dt">width =</span> .<span class="dv">25</span>, 
                <span class="kw">aes</span>(<span class="dt">ymin =</span> mean.prop-se, <span class="dt">ymax =</span> mean.prop+se)) +
  my.theme</code></pre>
<img src="figure/proportion-bars.png" width="450px" height="355px"  alt="" title="" />
</div>
<div class="section slide level1" id="section-7">

<div style="background: linear-gradient(#252525, #727272);
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
</b>Linguistic Data </b>
</p> 
<p align="center" style="font-family: Palatino; color:#CCCCCC; font-size:24pt"> 
  
Part 4: Geospatial Plotting and Possibilities for Sociolinguistics and Dialectology
</p> 
</div>
</div>
<div class="section slide level1" id="the-maps-package-contains-lots-of-geospatial-data">
<h1>The maps package contains lots of geospatial data</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;maps&quot;)</span>
<span class="kw">require</span>(maps)

<span class="co"># collect longitude and latitude coordinates for US states</span>
states &lt;- <span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)

<span class="kw">head</span>(states)</code></pre>
<pre><code>    long   lat group order  region subregion
1 -87.46 30.39     1     1 alabama      &lt;NA&gt;
2 -87.48 30.37     1     2 alabama      &lt;NA&gt;
3 -87.53 30.37     1     3 alabama      &lt;NA&gt;
4 -87.53 30.33     1     4 alabama      &lt;NA&gt;
5 -87.57 30.33     1     5 alabama      &lt;NA&gt;
6 -87.59 30.33     1     6 alabama      &lt;NA&gt;</code></pre>
</div>
<div class="section slide level1" id="plot-a-map-of-the-united-states">
<h1>Plot a map of the United States</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>states, <span class="kw">aes</span>(<span class="dt">map_id =</span> region, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>)) + 
    <span class="kw">geom_map</span>(<span class="dt">map =</span> states) + 
    <span class="kw">expand_limits</span>(<span class="dt">x =</span> states$long, <span class="dt">y =</span> states$lat)</code></pre>
<img src="figure/us-map.png" width="750px" height="500px"  alt="" title="" />
</div>
<div class="section slide level1" id="adjust-colors-and-coordinate-space">
<h1>Adjust colors and coordinate space</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>states, <span class="kw">aes</span>(<span class="dt">map_id =</span> region, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>)) + 
    <span class="co"># colour affects border, fill affects state regions</span>
    <span class="kw">geom_map</span>(<span class="dt">color=</span><span class="st">&quot;#757575&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightgray&quot;</span>, <span class="dt">map =</span> states) + 
    <span class="kw">expand_limits</span>(<span class="dt">x =</span> states$long, <span class="dt">y =</span> states$lat) + 
    <span class="kw">coord_map</span>() </code></pre>
<img src="figure/us-map-colored.png" width="750px" height="500px"  alt="" title="" />
</div>
<div class="section slide level1" id="read-in-random-latitidue-longitude-coordinates">
<h1>Read in random latitidue-longitude coordinates</h1>
<pre class="sourceCode r"><code class="sourceCode r">geo.dat &lt;- <span class="kw">read.delim</span>(<span class="st">&quot;datasets/fakedata_geo.txt&quot;</span>, <span class="dt">header=</span>T)

<span class="kw">head</span>(geo.dat)</code></pre>
<pre><code>   lat  long region group
1 41.6 -80.9   ohio     B
2 42.1 -83.9   ohio     D
3 39.7 -84.2   ohio     A
4 40.6 -82.4   ohio     B
5 39.7 -82.3   ohio     D
6 41.9 -82.5   ohio     A</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(geo.dat)</code></pre>
<pre><code>&#39;data.frame&#39;:   323 obs. of  4 variables:
 $ lat   : num  41.6 42.1 39.7 40.6 39.7 41.9 41.4 38.6 42.3 39.5 ...
 $ long  : num  -80.9 -83.9 -84.2 -82.4 -82.3 -82.5 -81.7 -84.1 -82.7 -82.2 ...
 $ region: Factor w/ 10 levels &quot;georgia&quot;,&quot;idaho&quot;,..: 6 6 6 6 6 6 6 6 6 6 ...
 $ group : Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 2 4 1 2 4 1 1 1 1 2 ...</code></pre>
<ul>
  <li>
coordinates generated with this <a href="http://www.geomidpoint.com/random/">random point generator</a>.
</li>
</ul>

</div>
<div class="section slide level1" id="overlay-points-on-the-map">
<h1>Overlay points on the map</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>states, <span class="kw">aes</span>(<span class="dt">map_id =</span> region, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>)) + 
    <span class="kw">geom_map</span>(<span class="dt">color=</span><span class="st">&quot;#757575&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightgray&quot;</span>, <span class="dt">map =</span> states) + 
    <span class="kw">expand_limits</span>(<span class="dt">x =</span> states$long, <span class="dt">y =</span> states$lat) + 
    <span class="kw">coord_map</span>() +
    <span class="kw">geom_point</span>(<span class="dt">data =</span> geo.dat, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span>group)) <span class="co"># HERE&#39;S THE MAGIC! </span></code></pre>
<img src="figure/us-map-plus-points.png" width="750px" height="500px"  alt="" title="" />
</div>
<div class="section slide level1" id="remove-axes-and-panel-background">
<h1>Remove axes and panel background</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>states, <span class="kw">aes</span>(<span class="dt">map_id =</span> region, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>)) + 
    <span class="kw">geom_map</span>(<span class="dt">color=</span><span class="st">&quot;#757575&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightgray&quot;</span>, <span class="dt">map =</span> states) + 
    <span class="kw">expand_limits</span>(<span class="dt">x =</span> states$long, <span class="dt">y =</span> states$lat) + 
    <span class="kw">coord_map</span>() + 
    <span class="kw">geom_point</span>(<span class="dt">data =</span> geo.dat, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span>group)) + 
    <span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),  <span class="co"># remove panel background</span>
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title =</span> <span class="kw">element_blank</span>())</code></pre>
<img src="figure/us-map-plus-points-noBackground.png" width="750px" height="500px"  alt="" title="" />
</div>
<div class="section slide level1" id="section-8">

<div style="background: linear-gradient(#252525, #727272); 
            background: -webkit-gradient(linear, left top, left bottom, from(#252525), to(#727272));
            background: -o-linear-gradient(top, #252525, #727272);
            background: -ms-linear-gradient(top, #252525, #727272);
            background: linear-gradient(to bottom, #252525, #727272);
            height:100%; 
            vertical-align: middle">
  
<BR><BR><BR>
<p align="center" style="font-family: Palatino; color:#CC0000; font-size:30pt"> 
  
</b>Thanks to: </b>
</p> 
<ul style="color: #CCCCCC; font-size:21pt; padding-left:50px">
    <li> 
Hadley Wickham, developer of <font style="color:#e67300">ggplot</font> and <font style="color:#e67300">plyr</font>, for dramatically improving my life as a data analyst
</li>
    <li> 
The vibrant StackOverflow and GitHub communities for continual inspiration
</li>
  </ul>
</div>




</div>
</body>
</html>
